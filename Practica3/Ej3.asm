PIO EQU 30H
PIC EQU 20H
TIMER EQU 10H
N_CLK EQU 10

ORG 40
IP_CLK DW RUT_CLK

ORG 1000H

ORG 3000H
RUT_CLK: MOV AL, CL
OUT PIO+1, AL
CMP CH, 0FFH
JZ INVERTIR
ADD CL, CL
CMP CL, 80H
JNZ FIN
XOR CH, 0FFH
JMP FIN
INVERTIR: MOV DL, 7
LOOP: ADD CL, CL
JNC SIG
INC CL
SIG: DEC DL
JNZ LOOP
CMP CL, 1
JNZ FIN
XOR CH, 0FFH
FIN: MOV AL, 0
OUT TIMER, AL
MOV AL, 20H
OUT PIC, AL
IRET


ORG 2000H
CLI
MOV AL, 0FDH
OUT PIC+1,AL
MOV AL, N_CLK
OUT PIC+5, AL
MOV AL, 1
OUT TIMER+1, AL
MOV AL, 0
OUT PIO, AL
MOV AL, 0FFH
OUT PIO+2, AL
MOV AL, 0
OUT PIO+1, AL
OUT PIO+3, AL
OUT TIMER, AL
MOV CL, 1
MOV CH, 0
STI
LAZO: JMP LAZO
HLT
END